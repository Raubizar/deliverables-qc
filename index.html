<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drawing QC - Desktop Application</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="desktop-app">
        <!-- Header -->
        <header class="app-header">
            <h1>Drawing QC</h1>
            <div class="header-controls">
                <button class="header-btn" onclick="showAbout()">‚ÑπÔ∏è About</button>
                <button class="header-btn" onclick="showSettings()">‚öôÔ∏è Settings</button>
            </div>
        </header>

        <!-- Main 3-Column Layout -->
        <main class="main-layout">
            
            <!-- Column 1: Input Files Section (25%) -->
            <div class="column column-1">
                <div class="column-header">
                    <h2>üìÅ Input Files</h2>
                </div>
                <div class="column-content">
                    
                    <div class="file-input-row">
                        <div class="file-input-item">
                            <div class="file-input-box">
                                <span class="file-icon">üìÅ</span>
                                <div class="file-input-content">
                                    <input type="file" id="selectFolder" webkitdirectory directory multiple>
                                    <label for="selectFolder" class="file-label">
                                        <span class="file-action">Select Folder</span>
                                        <span class="file-description">Root folder of files</span>
                                    </label>
                                </div>
                                <button class="choose-btn" onclick="document.getElementById('selectFolder').click()">Choose Folder</button>
                                <button class="choose-btn advanced-btn" onclick="selectFolderWithAPI()" title="Advanced folder selection with subdirectories">üìÅ+</button>
                            </div>
                            <div class="file-status">
                                <span class="checkmark">‚úì</span>
                                <span class="status-text">Selected: Drawings</span>
                            </div>
                        </div>
                    </div>

                    <div class="file-input-row">
                        <div class="file-input-item">
                            <div class="file-input-box">
                                <span class="file-icon">üìã</span>
                                <div class="file-input-content">
                                    <input type="file" id="registerFile" accept=".xlsx,.xls">
                                    <label for="registerFile" class="file-label">
                                        <span class="file-action">Drawing Register.xlsx</span>
                                        <span class="file-description">Drawing list/register</span>
                                    </label>
                                </div>
                                <button class="choose-btn" onclick="document.getElementById('registerFile').click()">Choose File</button>
                            </div>
                        </div>
                    </div>

                    <div class="file-input-row">
                        <div class="file-input-item">
                            <div class="file-input-box">
                                <span class="file-icon">üìù</span>
                                <div class="file-input-content">
                                    <input type="file" id="namingRulesFile" accept=".xlsx,.xls">
                                    <label for="namingRulesFile" class="file-label">
                                        <span class="file-action">Naming Rules.xlsx</span>
                                        <span class="file-description">Allowed file name parameters</span>
                                    </label>
                                </div>
                                <button class="choose-btn" onclick="document.getElementById('namingRulesFile').click()">Choose File</button>
                            </div>
                            <div class="file-note">üü°</div>
                        </div>
                    </div>

                    <div class="file-input-row">
                        <div class="file-input-item">
                            <div class="file-input-box">
                                <span class="file-icon">üè∑Ô∏è</span>
                                <div class="file-input-content">
                                    <input type="file" id="titleBlocksFile" accept=".xlsx,.xls">
                                    <label for="titleBlocksFile" class="file-label">
                                        <span class="file-action">Title Blocks.xlsx</span>
                                        <span class="file-description">Title block export</span>
                                    </label>
                                </div>
                                <button class="choose-btn" onclick="document.getElementById('titleBlocksFile').click()">Choose File</button>
                            </div>
                        </div>
                    </div>

                    <div class="file-filter-section">
                        <h3>File Type Filter</h3>
                        <select class="filter-dropdown" id="fileTypeFilter">
                            <option value="all">All Files</option>
                            <option value="pdf">PDF Only</option>
                            <option value="dwg">DWG Only</option>
                            <option value="other">Other Files</option>
                        </select>
                    </div>

                    <button class="run-checks-btn" id="runChecks">Run Checks</button>
                </div>
            </div>

            <!-- Column 2: User Configuration (25%) -->
            <div class="column column-2">
                <!-- Top Half: Expected Values -->
                <div class="column-section top-section">
                    <div class="section-header">
                        <h3>üéØ Expected Values</h3>
                        <p>For QA-QC Validation</p>
                    </div>
                    <div class="section-content">
                        <div class="expected-values-grid">
                            <div class="input-group">
                                <label for="revisionCode">Expected Revision Code:</label>
                                <input type="text" id="revisionCode" placeholder="e.g., P01">
                            </div>
                            
                            <div class="input-group">
                                <label for="revisionDate">Expected Revision Date:</label>
                                <input type="text" id="revisionDate" placeholder="e.g., 13.03.2025 or 13/03/25">
                            </div>
                            
                            <div class="input-group">
                                <label for="suitabilityCode">Expected Suitability Code:</label>
                                <input type="text" id="suitabilityCode" placeholder="e.g., S3">
                            </div>
                            
                            <div class="input-group">
                                <label for="stageDescription">Expected Stage Description:</label>
                                <input type="text" id="stageDescription" placeholder="e.g., Issued for Review">
                            </div>
                            
                            <div class="input-group">
                                <label for="revisionDescription">Expected Revision Description:</label>
                                <input type="text" id="revisionDescription" placeholder="e.g., Some description">
                            </div>
                            
                            <div class="input-group">
                                <label for="separator">Separator (Sheet Number - Sheet Name):</label>
                                <input type="text" id="separator" placeholder="e.g., ' - '" value=" - ">
                            </div>
                            
                            <div class="input-group checkbox-group">
                                <label for="checkOnlySheetNumber">
                                    <input type="checkbox" id="checkOnlySheetNumber">
                                    Check only Sheet Number
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom Half: Excel Configuration -->
                <div class="column-section bottom-section">
                    <div class="section-header">
                        <h3>üìä Excel Configuration</h3>
                        <p>Sheet and column selection for drawing register</p>
                    </div>
                    <div class="section-content">
                        <!-- Sheet and Column Selection Options -->
                        <div id="registerOptions" class="excel-options" style="display: none;">
                            <div class="selection-row">
                                <div class="selection-group">
                                    <label for="registerSheetSelect">Select Sheet:</label>
                                    <select id="registerSheetSelect" class="sheet-select">
                                        <option value="">Loading sheets...</option>
                                    </select>
                                </div>
                                <div class="selection-group">
                                    <label for="registerColumnSelect">Select Column for Drawing Names:</label>
                                    <select id="registerColumnSelect" class="column-select">
                                        <option value="">Select sheet first</option>
                                    </select>
                                </div>
                            </div>
                            <div class="selection-preview">
                                <strong>Preview:</strong>
                                <div id="registerPreview" class="preview-content">Select a column to see preview...</div>
                            </div>
                        </div>
                        
                        <div class="excel-placeholder" id="excelPlaceholder">
                            <div class="placeholder-content">
                                <span class="placeholder-icon">üìã</span>
                                <p>Upload a drawing register file to configure sheet and column selection</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Column 3: Results & Summary (50%) -->
            <div class="column column-3">
                <!-- Top Half: Summary Dashboard -->
                <div class="column-section top-section">
                    <div class="section-header">
                        <h3>üìà Summary Dashboard</h3>
                        <p>Overview and metrics</p>
                    </div>
                    <div class="section-content">
                        <div class="summary-dashboard-layout">
                            <div class="summary-metrics">
                                <div class="summary-item">
                                    <div class="summary-label">Drawings scanned</div>
                                    <div class="summary-value" id="drawingsScanned">95</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">Drawings in Register</div>
                                    <div class="summary-value missing" id="drawingsInRegister">33 missing</div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">Naming compliance</div>
                                    <div class="summary-value-with-bar">
                                        <span class="summary-value" id="namingCompliance">0% OK</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill red" style="width: 0%"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">Title block compliance</div>
                                    <div class="summary-value-with-bar">
                                        <span class="summary-value" id="titleBlockCompliance">0% OK</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill red" style="width: 0%"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="summary-item">
                                    <div class="summary-label">Overall compliance</div>
                                    <div class="summary-value-with-bar">
                                        <span class="summary-value" id="overallCompliance">0% OK</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill red" style="width: 0%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="summary-chart">
                                <div class="chart-container">
                                    <canvas id="complianceChart" width="150" height="150"></canvas>
                                    <div class="chart-legend">
                                        <div class="legend-item">
                                            <span class="legend-color ok"></span>
                                            <span>Compliant</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color error"></span>
                                            <span>Non-compliant</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom Half: Detailed Results -->
                <div class="column-section bottom-section">
                    <div class="section-header">
                        <h3>üìã Detailed Results</h3>
                        <div class="results-controls">
                            <input type="text" placeholder="Search results..." class="search-input">
                            <button class="download-btn">üì• Download XLSX Report</button>
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="results-tabs">
                            <button class="tab active" data-tab="drawing-list">Check Drawing List</button>
                            <button class="tab" data-tab="naming">Naming Checker</button>
                            <button class="tab" data-tab="validation">Deliverables QA-QC</button>
                        </div>

                        <div class="table-container">
                            <!-- Check Drawing List Tab -->
                            <div class="tab-content active" id="drawing-list">
                                <table class="results-table">
                                    <thead>
                                        <tr>
                                            <th>Excel Drawing Name</th>
                                            <th>Matched File Name</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="drawingListResults">
                                        <!-- Drawing list results will be populated here -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Naming Checker Tab -->
                            <div class="tab-content" id="naming">
                                <table class="results-table">
                                    <thead>
                                        <tr>
                                            <th>Folder Path</th>
                                            <th>File Name</th>
                                            <th>Compliance Status</th>
                                            <th>Details</th>
                                        </tr>
                                    </thead>
                                    <tbody id="namingResults">
                                        <!-- Naming checker results will be populated here -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Deliverables QA-QC Tab -->
                            <div class="tab-content" id="validation">
                                <table class="results-table">
                                    <thead>
                                        <tr>
                                            <th>Sheet Number</th>
                                            <th>Sheet Name</th>
                                            <th>File Name</th>
                                            <th>Revision Code</th>
                                            <th>Revision Date</th>
                                            <th>Revision Description</th>
                                            <th>Suitability Code</th>
                                            <th>Stage Description</th>
                                            <th>Naming Convention Status</th>
                                            <th>File Delivery Status</th>
                                            <th>Comments</th>
                                            <th>Result</th>
                                            <th>Mismatched Items</th>
                                        </tr>
                                    </thead>
                                    <tbody id="validationResults">
                                        <!-- QA-QC validation results will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
