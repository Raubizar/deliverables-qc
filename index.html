<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drawing QC</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Drawing QC</h1>
        
        <!-- Input Files Section -->
        <div class="input-files-section">
            <h2>üìÅ Input Files</h2>
            
            <div class="file-input-row">
                <div class="file-input-item">
                    <div class="file-input-box">
                        <span class="file-icon">üìÅ</span>
                        <div class="file-input-content">
                            <input type="file" id="selectFolder" webkitdirectory directory multiple>
                            <label for="selectFolder" class="file-label">
                                <span class="file-action">Select Folder</span>
                                <span class="file-description">Root folder of files</span>
                            </label>
                        </div>
                        <button class="choose-btn" onclick="document.getElementById('selectFolder').click()">Choose Folder</button>
                    </div>
                    <div class="file-status">
                        <span class="checkmark">‚úì</span>
                        <span class="status-text">Selected: Drawings</span>
                    </div>
                </div>
            </div>

            <div class="file-input-row">
                <div class="file-input-item">
                    <div class="file-input-box">
                        <span class="file-icon">üìã</span>
                        <div class="file-input-content">
                            <input type="file" id="registerFile" accept=".xlsx,.xls">
                            <label for="registerFile" class="file-label">
                                <span class="file-action">Registerdata</span>
                                <span class="file-description">Drawing register</span>
                            </label>
                        </div>
                        <button class="choose-btn" onclick="document.getElementById('registerFile').click()">Choose File</button>
                    </div>
                </div>
            </div>

            <div class="file-input-row">
                <div class="file-input-item">
                    <div class="file-input-box">
                        <span class="file-icon">üìù</span>
                        <div class="file-input-content">
                            <input type="file" id="namingRulesFile" accept=".xlsx,.xls">
                            <label for="namingRulesFile" class="file-label">
                                <span class="file-action">Naming Rules.xlsx</span>
                                <span class="file-description">Allowed file name parameters</span>
                            </label>
                        </div>
                        <button class="choose-btn" onclick="document.getElementById('namingRulesFile').click()">Choose File</button>
                    </div>
                    <div class="file-note">üü°</div>
                </div>
            </div>

            <div class="file-input-row">
                <div class="file-input-item">
                    <div class="file-input-box">
                        <span class="file-icon">üè∑Ô∏è</span>
                        <div class="file-input-content">
                            <input type="file" id="titleBlocksFile" accept=".xlsx,.xls">
                            <label for="titleBlocksFile" class="file-label">
                                <span class="file-action">Title Blocks.xlsx</span>
                                <span class="file-description">Title block export</span>
                            </label>
                        </div>
                        <button class="choose-btn" onclick="document.getElementById('titleBlocksFile').click()">Choose File</button>
                    </div>
                </div>
            </div>

            <div class="file-filter-section">
                <h3>File Type Filter</h3>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all" id="filterAll">All Files</button>
                    <button class="filter-btn" data-filter="pdf" id="filterPDF">PDF Only</button>
                    <button class="filter-btn" data-filter="dwg" id="filterDWG">DWG Only</button>
                    <button class="filter-btn" data-filter="other" id="filterOther">Other Files</button>
                </div>
            </div>

            <button class="run-checks-btn" id="runChecks">Run Checks</button>
        </div>

        <!-- Expected Values Section (QA-QC Tab Only) -->
        <div class="expected-values-section" id="expectedValuesSection" style="display: none;">
            <h2>Expected Values (for QA-QC Validation)</h2>
            
            <div class="expected-values-grid">
                <div class="input-group">
                    <label for="revisionCode">Expected Revision Code:</label>
                    <input type="text" id="revisionCode" placeholder="e.g., P01">
                </div>
                
                <div class="input-group">
                    <label for="revisionDate">Expected Revision Date:</label>
                    <input type="text" id="revisionDate" placeholder="e.g., 13.03.2025 or 13/03/25">
                </div>
                
                <div class="input-group">
                    <label for="suitabilityCode">Expected Suitability Code:</label>
                    <input type="text" id="suitabilityCode" placeholder="e.g., S3">
                </div>
                
                <div class="input-group">
                    <label for="stageDescription">Expected Stage Description:</label>
                    <input type="text" id="stageDescription" placeholder="e.g., Issued for Review">
                </div>
                
                <div class="input-group">
                    <label for="revisionDescription">Expected Revision Description:</label>
                    <input type="text" id="revisionDescription" placeholder="e.g., Some description">
                </div>
                
                <div class="input-group">
                    <label for="separator">Separator (Sheet Number - Sheet Name):</label>
                    <input type="text" id="separator" placeholder="e.g., ' - '" value=" - ">
                </div>
                
                <div class="input-group checkbox-group">
                    <label for="checkOnlySheetNumber">
                        <input type="checkbox" id="checkOnlySheetNumber">
                        Check only Sheet Number
                    </label>
                </div>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section">
            <h2>Summary</h2>
            
            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-label">Drawings scanned</div>
                    <div class="summary-value" id="drawingsScanned">95</div>
                </div>
                
                <div class="summary-item">
                    <div class="summary-label">Drawings in Register</div>
                    <div class="summary-value missing" id="drawingsInRegister">33 missing</div>
                </div>
                
                <div class="summary-item">
                    <div class="summary-label">Naming compliance</div>
                    <div class="summary-value-with-bar">
                        <span class="summary-value" id="namingCompliance">0% OK</span>
                        <div class="progress-bar">
                            <div class="progress-fill red" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="summary-item">
                    <div class="summary-label">Title block compliance</div>
                    <div class="summary-value-with-bar">
                        <span class="summary-value" id="titleBlockCompliance">0% OK</span>
                        <div class="progress-bar">
                            <div class="progress-fill red" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="summary-item">
                    <div class="summary-label">Overall compliance</div>
                    <div class="summary-value-with-bar">
                        <span class="summary-value" id="overallCompliance">0% OK</span>
                        <div class="progress-bar">
                            <div class="progress-fill red" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section">
            <div class="results-header">
                <h2>Results</h2>
                <div class="results-controls">
                    <input type="text" placeholder="Search results..." class="search-input">
                    <button class="download-btn">üì• Download XLSX Report</button>
                </div>
            </div>
            
            <div class="results-tabs">
                <button class="tab active" data-tab="drawing-list">Check Drawing List</button>
                <button class="tab" data-tab="naming">Naming Checker</button>
                <button class="tab" data-tab="validation">Deliverables QA-QC</button>
            </div>

            <div class="table-container">
                <!-- Check Drawing List Tab -->
                <div class="tab-content active" id="drawing-list">
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Excel Drawing Name</th>
                                <th>Matched File Name</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="drawingListResults">
                            <!-- Drawing list results will be populated here -->
                        </tbody>
                    </table>
                </div>

                <!-- Naming Checker Tab -->
                <div class="tab-content" id="naming">
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Folder Path</th>
                                <th>File Name</th>
                                <th>Compliance Status</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="namingResults">
                            <!-- Naming checker results will be populated here -->
                        </tbody>
                    </table>
                </div>

                <!-- Deliverables QA-QC Tab -->
                <div class="tab-content" id="validation">
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Sheet Number</th>
                                <th>Sheet Name</th>
                                <th>File Name</th>
                                <th>Revision Code</th>
                                <th>Revision Date</th>
                                <th>Revision Description</th>
                                <th>Suitability Code</th>
                                <th>Stage Description</th>
                                <th>Naming Convention Status</th>
                                <th>File Delivery Status</th>
                                <th>Comments</th>
                                <th>Result</th>
                                <th>Mismatched Items</th>
                            </tr>
                        </thead>
                        <tbody id="validationResults">
                            <!-- QA-QC validation results will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
